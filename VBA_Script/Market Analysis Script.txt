Sub Ticker():    Dim ws As Worksheet    Dim starting_ws As Worksheet    Set starting_ws = ActiveSheet    For Each ws In ThisWorkbook.Worksheets    ws.Activate    Dim YearOpen As Double    Dim YearClose As Double                  Dim Stock_Name As String    Dim Stock_Total As Double    Stock_Total = 0    Dim Summary_Table_Row As Integer    Summary_Table_Row = 2    Dim Summary_Table_Row11 As Integer    Summary_Table_Row11 = 2     Cells(1, 10).Value = "Ticker"     Cells(1, 11).Value = "Yearly Change"     Cells(1, 12).Value = "Percent Change"     Cells(1, 13).Value = "Total Stock Volume"    For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row            If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then            Stock_Name = Cells(i, 1).Value            Stock_Total = Stock_Total + Cells(i, 7).Value            Range("J" & Summary_Table_Row).Value = Stock_Name            Range("M" & Summary_Table_Row).Value = Stock_Total            Summary_Table_Row = Summary_Table_Row + 1            Stock_Total = 0         Else            Stock_Total = Stock_Total + Cells(i, 7).Value         End If    Next i    For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row              If Cells(i, 1).Value <> Cells(i - 1, 1).Value Then                YearOpen = Cells(i, 3).Value         End If                                                        If Cells(i, 1).Value <> Cells(i + 1, 1) Then                 YearClose = Cells(i, 6).Value                 Range("K" & Summary_Table_Row11).Value = (YearClose - YearOpen)                    If YearOpen <> 0 Then                       Range("L" & Summary_Table_Row11).Value = Format(Round((YearClose - YearOpen) / (YearOpen), 4), "Percent")                    Else                        Range("L" & Summary_Table_Row11).Value = 0                    End If                 Summary_Table_Row11 = Summary_Table_Row11 + 1          Else          End If          If Cells(i, 11) > 0 Then             Cells(i, 11).Interior.ColorIndex = 4          ElseIf Cells(i, 11) < 0 Then             Cells(i, 11).Interior.ColorIndex = 3          End If    Next i    For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row            If Cells(i, 11) > 0 Then             Cells(i, 11).Interior.ColorIndex = 4          ElseIf Cells(i, 11) < 0 Then             Cells(i, 11).Interior.ColorIndex = 3          End If    Next i    Cells(2, 16).Value = "Greatest % Increase"    Cells(1, 17).Value = "Ticker"    Cells(1, 18).Value = "Value"    Cells(2, 18).Value = Format(Application.WorksheetFunction.Max(Range("l:l")), "Percent")    Cells(3, 16).Value = "Greatest % Decrease"    Cells(3, 18).Value = Format(Application.WorksheetFunction.Min(Range("l:l")), "Percent")       Cells(4, 16).Value = "Greatest Total Volume"    Cells(4, 18).Value = Application.WorksheetFunction.Max(Range("m:m"))    For i = 2 To Cells(Rows.Count, 1).End(xlUp).Row    If Cells(i, 12) = Cells(2, 18).Value Then       Cells(2, 17).Value = Cells(i, 10).Value    End If    If Cells(i, 12) = Cells(3, 18).Value Then       Cells(3, 17).Value = Cells(i, 10).Value    End If    If Cells(i, 13) = Cells(4, 18).Value Then       Cells(4, 17).Value = Cells(i, 10).Value    End If        Next iNext wsEnd Sub